<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Dashboard | Skin Cancer Detection</title>
<style>
  *{margin:0; padding:0; box-sizing:border-box; font-family:'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;}
  body{min-height:100vh; background-color:#f5f5f5; display:flex; color:#333;}
  .sidebar{width:220px; background-color:#1E3A8A; color:white; display:flex; flex-direction:column; padding:20px; position:fixed; height:100%; box-shadow:0 4px 12px rgba(0,0,0,0.15);}
  .sidebar h2{margin-bottom:30px; font-size:22px; text-align:center;}
  .sidebar a{text-decoration:none; color:#cce0ff; padding:12px 15px; margin:8px 0; border-radius:8px; display:block; transition:.3s; font-weight:500; border-bottom:1px solid rgba(255,255,255,0.2);}
  .sidebar a:last-child{border-bottom:none;}
  .sidebar a:hover{background-color:#007ea7; color:white; border-left:4px solid #1dd1a1; padding-left:11px;}
  .main-content{margin-left:240px; padding:30px; width:calc(100% - 240px);}
  .main-content h1{margin-bottom:20px; font-size:28px; color:#1E3A8A;}
  .cards{display:flex; flex-wrap:wrap; gap:20px; margin-bottom:30px;}
  .card{flex:1 1 250px; background-color:#fff; border-left:6px solid #007ea7; border-radius:12px; padding:25px; box-shadow:0 4px 12px rgba(0,0,0,0.08); transition:.2s;}
  .card:hover{transform:translateY(-5px); box-shadow:0 6px 18px rgba(0,0,0,0.15);}
  .card h3{margin-bottom:15px; font-size:20px; color:#1E3A8A;}
  .card p{font-size:16px;}
  .upload-section{background-color:#fff; border-radius:12px; padding:25px; box-shadow:0 4px 12px rgba(0,0,0,0.08); margin-bottom:30px;}
  .upload-section h3{margin-bottom:15px; color:#1E3A8A;}
  .upload-section input[type="file"]{padding:10px; border-radius:8px; border:1px solid #ccc; margin-bottom:15px; width:100%;}
  .upload-section button{padding:12px 20px; border:none; border-radius:8px; background-color:#1dd1a1; color:#fff; font-weight:bold; cursor:pointer; transition:.3s;}
  .upload-section button:hover{background-color:#10ac84;}
  table{width:100%; border-collapse:collapse; background-color:#fff; border-radius:12px; overflow:hidden; box-shadow:0 4px 12px rgba(0,0,0,0.08);}
  th, td{padding:12px 15px; text-align:left;}
  th{background-color:#007ea7; color:#fff;}
  tr:nth-child(even) td{background-color:#f9f9f9;}
  @media(max-width:900px){.cards{flex-direction:column;}.main-content{margin-left:0;width:100%;}.sidebar{width:100%; flex-direction:row; justify-content:space-around; height:auto;}.sidebar a{border-bottom:1px solid rgba(255,255,255,0.2);}.sidebar a:last-child{border-bottom:none;}}
</style>
</head>
<body>

<div class="sidebar">
  <h2>Skin Cancer</h2>
  <a href="home.html">Home</a>
  <a href="#">Upload</a>
  <a href="#">History</a>
  <a href="#">Profile</a>
  <a href="#" id="logout">Logout</a>
</div>

<div class="main-content">
  <h1>Dashboard</h1>

  <!-- Stats Cards -->
  <div class="cards">
    <div class="card">
      <h3>Total Users</h3>
      <p id="total-users">0</p>
    </div>
    <div class="card">
      <h3>Predictions Made</h3>
      <p id="total-predictions">0</p>
    </div>
    <div class="card">
      <h3>Positive Cases</h3>
      <p id="positive-cases">0</p>
    </div>
  </div>

  <!-- Upload Section -->
  <div class="upload-section">
    <h3>Upload Skin Image</h3>
    <input type="file" id="image-upload" accept="image/*" />
    <button id="analyze-btn">Analyze</button>
  </div>

  <!-- Recent Predictions -->
  <div class="recent-predictions">
    <h3>Recent Predictions</h3>
    <table id="recent-table">
      <thead>
        <tr><th>User</th><th>Date</th><th>Result</th></tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>
</div>

<script>
const logoutBtn = document.getElementById("logout");
const analyzeBtn = document.getElementById("analyze-btn");
const imageUpload = document.getElementById("image-upload");
const currentUser = JSON.parse(localStorage.getItem("currentUser"));

// Redirect to login if no user
if(!currentUser) window.location.href = "login.html";

// Logout
logoutBtn.addEventListener("click", () => {
  localStorage.removeItem("currentUser");
  window.location.href = "login.html";
});

// Load recent predictions
function loadRecentPredictions(){
  const predictions = JSON.parse(localStorage.getItem("predictions") || "[]");
  const userPredictions = predictions.filter(p => p.userEmail === currentUser.email);
  document.getElementById("recent-table").querySelector("tbody").innerHTML = "";
  userPredictions.forEach(p => {
    document.getElementById("recent-table").querySelector("tbody").innerHTML += `<tr>
      <td>${currentUser.name}</td>
      <td>${p.date}</td>
      <td>${p.result}</td>
    </tr>`;
  });
  document.getElementById("total-users").innerText = JSON.parse(localStorage.getItem("users") || "[]").length;
  document.getElementById("total-predictions").innerText = predictions.length;
  const positive = predictions.filter(p=>p.result==="Malignant").length;
  document.getElementById("positive-cases").innerText = positive;
}

loadRecentPredictions();

// Analyze button
analyzeBtn.addEventListener("click", ()=>{
  const file = imageUpload.files[0];
  if(!file){ alert("Please select an image"); return; }
  const predictions = JSON.parse(localStorage.getItem("predictions") || "[]");
  // Random result for demo
  const result = Math.random()>0.5?"Benign":"Malignant";
  predictions.push({
    userEmail: currentUser.email,
    result: result,
    date: new Date().toLocaleString()
  });
  localStorage.setItem("predictions", JSON.stringify(predictions));
  loadRecentPredictions();
  alert("Analysis Complete: " + result);
});
</script>

</body>
</html>
